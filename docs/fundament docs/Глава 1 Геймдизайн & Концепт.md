**1\. Геймдизайн & Концепт (v1)**

**1.1 Core fantasy и жанровой тон**

**Сеттинг и «core fantasy»**

- **Жанр:** героическое фэнтези, SRD-совместимый (без прямых IP-зависимостей).
- **Нарратив/опыт:** визуельный стиль и приключения в духе серии игр "might and magic"
- **Core fantasy:** «Вы — отряд искателей, который быстро и осмысленно принимает решения в опасных ситуациях; даже провалы двигают историю вперёд» (_fail-forward_).

**Тон-гайд (основы)**

| **Ось** | **Значение** | **Комментарий** |
| --- | --- | --- |
| Свет ↔ Мрак | **Полумрак** | Риски ощутимы, без безысходности |
| Ирония ↔ Серьёзность | **Умеренная ирония** | Лёгкие реплики, без фарса |
| Героизм ↔ Цинизм | **Героизм** | Поддержка командного духа |
| Жестокость | **Сдержанная** | Без «сплаттера» и натурализма |

**Запреты/чувствительные темы:** сексуальное насилие, жестокость к детям/животным, графические пытки, разжигание ненависти и т.п.  
**Инструменты безопасности:** «Lines & Veils», X-Card-аналог, пользовательские контент-тогглы в Настройках.

**Питч ≤150 слов**

RPG-Bot — кооперативное текстовое итерактивно новельное приключение в Telegram. Вы — небольшой отряд искателей, проходящий через переговоры, ловушки и стычки. Каждая сцена компактна: три осмысленных выбора и один свободный ход, а последствия определяются проверками и контекстом. Система _fail-forward_ гарантирует движение истории — даже неудача открывает новые пути. Бой лёгкий: инициатива d20+DEX, действие/перемещение/реакция, простые статусы. Для пати есть голосование и гибкий таймер; Мастер может готовить, редактировать и публиковать сцены с аудитом. Тон — героический, с умеренной иронией, без крайних тем. Опциональные медиа (фон-арт и TTS) в том числе активный диалог с npc когда ИИ отыгрывает роль и по итогу влияет на сюжет повышают иммерсию, но текст остаётся источником правды. NFT-механики и Биржа — необязательные и включаются только в отмеченных модулях.

**1.2 Core loop и темп (финальные решения)**

**Базовый цикл (финал)**

\[СЦЕНА 450–900 знаков\]

↓

\[ВЫБОР: 1 / 2 / 3 + «СВОЙ ХОД»\]

↓

\[ПРОВЕРКА/ЛОГИКА → ПОСЛЕДСТВИЯ: ✓ / ~ / ✗\]

↓

\[СЛЕДУЮЩАЯ СЦЕНА или БОЙ\] ↺

- **Варианты:** ровно **3** кнопки + **«Свой ход»** (текст игрока) — принято как дефолт во всех сценах.
- **Длина сцены:** 450–900 знаков (целим в 600–750).
- **Темп решения:** соло 20–40 с/ход; пати 30–90 с/ход (включая голосование).

**Матрица последствий (_fail-forward_)**

| **Итог** | **Что значит** | **Системная реакция (примеры)** |
| --- | --- | --- |
| **Успех (✓)** | Цель достигнута, позиция улучшена | тэг «Преимущество», сокращение «Тревоги», зацепка лута |
| **Частичный (~)** | Цель достигнута ценой или с риском | ресурс −1, статус «Ранен», усложнённый переход |
| **Провал (✗)** | Цель не достигнута, история движется | ухудшение позиции, новая угроза, обходной путь |

**1.3 Подача контента и медиа-пайплайн**

**Режимы подачи (переключаемые в Настройках):**

- **Кинематографичный:** (опц.) сначала фон-арт 1–2 с → текст → (опц.) авто-TTS; далее выборы.
- **Скоростной:** сразу текст; арт/TTS по кнопке.

**Пайплайн под капотом:**  
\[GEN-I фон (опц.)\] → \[GEN-T сцена\] → \[GEN-V TTS (опц.)\] → \[HINT/ASK чипы\] → выборы → \[GEN-T последствия (+ микро-арт лута опц.)\].

Текст всегда первичен; медиа — опционально и управляется пользователем.

**1.4 Бой (Combat-Lite v1)**

**Характеристики:** STR/DEX/CON/INT/WIS/CHA (моды), HP; AC — абстрактно.  
**Инициатива:** d20 + DEX (дефолт).  
**Ход:** Перемещение (1 «зона») + 1 Действие + 1 Реакция.  
**Примеры действий:** атака, помощь, укрытие, взаимодействие, особое умение.  
**Преимущество/Помеха:** advantage/disadvantage.  
**Статусы (минимум):**

- «Оглушение» — пропуск Действия/Реакции; проверка CON в конце хода.
- «Кровотечение» — −1 HP/раунд до лечения/перевязки.
- «Вдохновение» — одноразовое преимущество на бросок.  
    **Выход из боя:** цель выполнена / противник деморализован / 3 раунда без урона / побег.

_Артефакт:_ «Combat-Lite Appendix» — краткий свод действий, статусы с иконками, 1–2 журнальных примера.

**1.5 Пати, голосование и таймер**

- **Голосование:** простое большинство среди поданных голосов; ничья — d20 между лидерами.
- **Таймер:** диапазон 15–180 с; меняется **хостом/GM** до старта и «на лету» (вступает со следующей сценой).
- **Продление:** +45 с 1 раз/сцена по голосованию большинства.
- **Анти-абьюз:** лимит продлений; rate-limit «Свой ход»; AFK-детектор.

**1.6 Co-DM / DM (меню мастера) — инструментарий**

**Модули:**

1.  **Director \[DIR\]** — строгость правил (RAW↔Cinematic), плотность боёв, автоподбор DC, доля частичных успехов.
2.  **Lorebook \[LORE\]** — загрузка лора/фактов, область видимости (игрокам/только ИИ), приоритеты.
3.  **NPC Studio \[GEN-NPC/GEN-I\]** — профили NPC (цели/манеры/голос), реплики, портреты.
4.  **Scene Builder \[GEN-T/REWRITE/RULE\]** — мастер сцен по схеме (цель, риск, навыки, теги, лут).
5.  **Skeletons (сюжетный билдер)** — **граф-редактор** приключения (узлы/гейты/ветки) с **Playtest**.
6.  **Asset Vault \[FIND/TAG\]** — загрузка артов/аудио/карт, авто-тэги.
7.  **Rule Finder \[RULE\]** — быстрые цитаты SRD/канона, «показать игрокам».
8.  **Logbook & Analytics \[SUMM\]** — темп/голоса/броски/AFK, сводки и экспорт.
9.  **GM Actions (в RUN)** — пауза, шёпот игроку, скрытый бросок, **override с причиной**, реткон ≤1 шага (с аудитом).

**1.7 Смена сцен, структура приключения и «скелеты»**

**Режимы смены сцен:**

- **Авторский граф** — фикс-узлы и переходы.
- **Маршрут-«колода»** — движок выбирает тип следующей сцены по правилам «колоды».
- **AI-дирижёр** — ключевые узлы фиксированы, промежуточные сцены/варианты описаний генерируются ИИ по схеме.
- **Гибрид (дефолт)** — фикс-вехи + ИИ-связки.

**Гейты/условия переходов:** проверка навыка (DC), ресурсы (золото/ключ), время/тревога, предмет, тэг состояния (Ranen/Wanted), исход предыдущей сцены (✓/~/✗).

**Библиотека «скелетов» (паттерны):** Three-Act Quest, Heist, Investigation, Dungeon Crawl, Escort/Convoy, Survival, Siege/Defense, Monster Hunt, Political Intrigue, Hexcrawl (песочница), Chase, Time-Loop.

**1.8 RUN-сцены: шаблоны (классика D&D) — 15 типов**

Каждый шаблон поставляет: **контекст 1–2 строки → 3 выбора + «Свой ход» → список проверок → тип последствий**.

1.  Исследование комнаты/руин (Внимательность/Выживание/Аркана)
2.  Социальная сцена: переговоры/допрос (Убеждение/Проницательность/Запугивание)
3.  Ловушка/механизм (Акробатика/DEX-взлом/Аркана)
4.  Экологическая опасность (Атлетика/Выживание/CON)
5.  Погоня (Атлетика/Акробатика/Навигация)
6.  Допрос пленных/свидетеля (WIS/CHA)
7.  Засада/старт боя (Скрытность/Инициатива)
8.  Дальняя разведка/следопыт (Выживание/Восприятие)
9.  Пазл/код (INT-навыки)
10. Лагерь/привал (Лечение/Ремонт/Дозор)
11. Городская сцена (Торговля/Убеждение/Обман)
12. Босс/сет-пись (комбинированно)
13. Моральная дилемма (WIS/CHA)
14. Инфильтрация (Скрытность/Обман/Лазание)
15. Арканный феномен (Аркана/Религия)

**1.9 AI ⇄ пользователь: ярлыки взаимодействий и размещение**

**Таксономия ярлыков (стандарт)**

**Guidance:** \[ASK\] Спросить совет, \[TACT\] Тактическая подсказка, \[COACH\] Билдо-совет, \[RECOM\] Рекомендации.  
**Knowledge:** \[RULE\] Правило, \[LORE\] Лор, \[EXPL\] Объяснить, \[SUMM\] Сводка, \[TRAN\] Перевод.  
**Creation:** \[GEN-T\] Текст, \[GEN-I\] Картинка, \[GEN-V\] Голос/TTS, \[GEN-MAP\] Карта/схема, \[GEN-NPC\] NPC, \[REWRITE\] Переформат.  
**Operations (авто):** \[DIR\] Директор, \[CONT\] Континуитет, \[SAFE\] Безопасность, \[FIND\] Поиск, \[TAG\] Тэггер.

**Встраивание в UI**

- **RUN-Scene:** панель чипов: \[ASK\]\[TACT\]\[RULE\]\[LORE\]\[GEN-T\]\[GEN-I\]\[GEN-V\] + кнопка «AI» (док-панель с вкладками).
- **RUN-Combat:** \[TACT\]\[RULE\]\[SUMM\] + боковая \[GEN-MAP\].
- **Персонаж/Инвентарь:** \[COACH\], \[RULE\] на карточках предметов/навыков.
- **Библиотека/Новое приключение:** \[RECOM\] + превью-арт \[GEN-I\].
- **Меню Мастера:** панель генерации: \[GEN-T\]\[GEN-NPC\]\[GEN-MAP\]\[GEN-I\]\[REWRITE\]\[RULE\]\[FIND\]\[LORE\], карусель хинтов \[DIR\].

**1.10 Персонаж (канон, кастомизация, слоты)**

- **Атрибуты:** STR/DEX/CON/INT/WIS/CHA (моды), HP, AC (абстрактно).
- **Навыки (эталон каноничных редакций, будет уточнено в балансе):** Атлетика, Акробатика, Внимательность, Проницательность, Выживание, Убеждение, Запугивание, Обман, Аркана/Религия.
- **Слоты экипировки:**
    - Оружие: основная / вторая (или щит) / дальнобойное
    - Доспехи: голова / торс / руки / пояс / ноги / обувь / плащ
    - Аксессуары: ×3 (кольца/амулеты)
    - **Attunement:** ×3 для магических/редких
- **Летопись:** ключевые сцены, броски, лут, достижения (бейджи).
- **Профиль правил (переключатель):** Strict RAW (дефолт) / Cinematic / Homebrew — влияет на проверки, подсказки, авто-DC.

**1.11 Инвентарь, ресурсы и редкости**

- **Категории:** Оружие, Доспехи, Аксессуары, Расходники, Инструменты, Материалы, Квестовые, Прочее.
- **Ресурсы:** золото (**gp**), серебро (**sp**), медь (**cp**); провизия/рационы; боеприпасы; факелы.
- **Переносимость:** слотовая (дефолт 12 слотов; расширяется сумками/баюком).
- **Редкости (принято 6):** **Common / Uncommon / Rare / Epic / Legendary / Mythic**.
- **Метки:** **soulbound** (нельзя обменять), **tradeable**, «хрупкий», «сетовый».
- **Склад (Stash):** вне приключения — безопасное хранилище.

**1.12 Библиотека приключений и награды**

- **Витрины:** Официальные (админ), Пользовательские (проверенные), Трендовые (рейтинг).
- **Теги:** длительность, жанр, % боёв, сложность, Solo/Party/GM-required, контент-фильтры.
- **Награды:**
    - **Бейджи/титулы** (обычные).
    - **Предметы экипировки** (игровые; без p2w-перекоса).
    - **NFT-награды** — **только** в модулях с флагом nftRewards:true: Proof-of-Adventure, косметические рамки, редкие tradeable-предметы (ограничения и политика анти-p2w обязательны).

**1.13 Настройки (best practice, 2025)**

- **Доступность:** размер шрифта, контраст, «без картинок/анимаций», TTS авто/ручной, субтитры, шрифт для дислексии.
- **Контент:** пользовательские «Lines & Veils», режим «без ужаса/жести», фильтр обсценной лексики.
- **Геймплей:** скорость вывода текста, длина сцены (краткая/стандарт), плотность подсказок, публичность бросков, детализация боя.
- **Интерфейс:** компакт «3+1» кнопки, крупные кнопки, вибро-отклик.
- **Аудио/Видео:** громкость TTS/амбиента, авто-приглушение, качество изображений.
- **Приватность:** телеметрия (минимум/стандарт), шаринг прогресса, скрывать ник/портрет в пати.
- **Локаль:** язык, формат времени.
- **Уведомления:** «ваша сцена», «приглас в пати», «получен лут».
- **Профиль GM:** дефолтный тон, строгость, автогенерация артов: вкл/выкл.

**1.14 Экономика и нагрузка (рамки, без «энергии»)**

- **Никогда нет «энергии».** Нагрузочные механики и монетизацию планируем **после** оценки средних затрат на персонажа/сессию (в главах про данные/операции).
- Допустимые «мягкие» механики (TBD в последующих главах): пассы доступности (не p2w), приоритет очередей, дополнительные конкурентные сессии, поощрение off-peak.

**1.15 NFT-слой (опционально)**

- Полностью **опционально** и отключаемо.
- **Точки интеграции:**
    - Персонаж → «Сделать NFT-персонажа» (динамический метадатчик прогресса).
    - Инвентарь → «Сделать NFT-предмет» (для не-soulbound).
    - Журнал → Proof-of-Adventure.
- Используется **только** в отмеченных модулях; политика анти-p2w обязательна.

**1.16 Точки входа и навигация верхнего уровня (IA-саммари)**

**Entry points:** /start Mini App; deep-link adventure_id; приглашение invite_code; «Продолжить сессию»; вход GM/Co-DM; deep-link на товар/магазин.  
**Главное меню:** Новое приключение → Режим/Каталог/Лобби → Старт; Продолжить; Меню Мастера; Персонаж; Инвентарь; Журнал; Библиотека; Магазин; Пати; Настройки; Помощь.  
**RUN-режим:** Сцена (3+«Свой») ↔ Бой (Combat-Lite) ↔ Итоги/Лут/Вехи.

_(Полная карта IA/энд-страниц будет зафиксирована в главе 2 «UX-флоу & UI-навигация».)_

**1.17 Акцептанс-критерии главы (DoR/DoD) и Vertical Slice**

**Definition of Ready (глава 1):**

- Утверждены: тон-гайд, запреты, core loop (3+«Свой»), длина/темп, _fail-forward_.
- Утверждены: Combat-Lite v1, Пати/голосование, Co-DM инструментарий (модули).
- Утверждены: библиотека скелетов (перечень), RUN-шаблоны (15 типов), ярлыки ИИ и их размещение.
- Утверждены: инвентарь, редкости ×6, персонажные слоты, настройки (список).
- Зафиксированы опциональные NFT-точки.

**Definition of Done (глава 1):**

- Диаграммы: core loop, Co-DM state, пример «скелета» (Heist).
- Таблицы: тон-гайд, последствия, статусы боя, ярлыки ИИ, редкости/метки.
- «Combat-Lite Appendix» готов; «Party & Co-DM Protocol» готов.
- RUN-шаблоны описаны карточками (микро-ТЗ на тип сцены).
- Вертикальный срез (Vertical Slice Plan): 1 локация, 2–3 сцены + 1 бой, пати-таймер включен, Co-DM доступен, арт/TTS опциональны.

**Приложение A. Легенда ИИ-ярлыков (для вёрстки/редактора)**

| **Код** | **Название** | **Тип контента** | **Где показывать** | **Режим** |
| --- | --- | --- | --- | --- |
| ASK | Спросить совет | текст | RUN-Scene/Combat (панель чипов) | по кнопке |
| TACT | Тактическая подсказка | текст | RUN-Combat/Scene | по кнопке |
| COACH | Билдо-совет | текст | Персонаж/Инвентарь | по кнопке |
| RECOM | Рекомендации | текст | Библиотека/Новое приключение | по кнопке |
| RULE | Правило | текст/цитата | Везде (контекстно) | по кнопке |
| LORE | Лор | текст | RUN/Редактор | по кнопке |
| EXPL | Объяснить | текст | RUN/Инвентарь | по кнопке |
| SUMM | Сводка | текст | RUN/Журнал/Лобби | по кнопке/авто |
| TRAN | Перевод | текст | RUN | по кнопке |
| GEN-T | Ген. текста | текст | RUN/Редактор | по кнопке |
| GEN-I | Ген. изображения | изображение | RUN/Редактор | по кнопке |
| GEN-V | Озвучка | аудио | RUN/Настройки | по кнопке/авто |
| GEN-MAP | Карта/схема | изображение | RUN-Combat/Редактор | по кнопке |
| GEN-NPC | NPC-профиль | текст/изобр. | Редактор | по кнопке |
| REWRITE | Переформат | текст | RUN/Редактор | по кнопке |
| DIR | Директор | служебное | RUN/Редактор | авто |
| CONT | Континуитет | служебное | RUN | авто |
| SAFE | Безопасность | служебное | RUN/Редактор | авто |
| FIND | Поиск | служебное | Редактор/Валты | по кнопке |
| TAG | Тэггер | служебное | Редактор/Импорт | авто |

**Приложение B. Шаблоны для «Сюжетного билдера»**

**NodeSchema v1 (минимум):**

{

"id":"N1",

"type":"Social",

"title":"Гильдия перевозчиков",

"goal":"Получить пропуск",

"skills":\["Убеждение","Проницательность"\],

"risk":"Подозрение и потеря времени",

"loot":\["Пропуск","Наводка"\],

"tags":\["город","день"\],

"media":{"needImage":true,"needTTS":false}

}

**EdgeSchema v1 (условный переход):**

{

"from":"N1",

"to":"N2",

"condition":{"type":"skill","name":"Убеждение","dc":12,"onFail":"N3"}

}

**AdventureSkeletonSchema v1 (контейнер):**

{

"id":"skel_heist_v1",

"pattern":"Heist",

"nodes":\[/\* NodeSchema\[\] \*/\],

"edges":\[/\* EdgeSchema\[\] \*/\],

"director":{"pace":"medium","combatFreq":"low","failForward":true},

"contentFilters":{"horror":false,"gore":false},

"mediaPolicy":{"image":true,"tts":"opt-in"}

}

**Приложение C. SceneSchema v1 (для RUN-редактора/ИИ)**

{

"sceneId":"S-001",

"type":"Exploration",

"tone":"heroic_semidark",

"textTargetChars":700,

"contextTags":\["ruins","dusk"\],

"choices":\[

{"id":"c1","label":"Осмотреть алтарь","skillCheck":{"skill":"Аркана","dc":12}},

{"id":"c2","label":"Проверить следы","skillCheck":{"skill":"Выживание","dc":10}},

{"id":"c3","label":"Вскрыть тайник","skillCheck":{"skill":"Воровство","dc":14}},

{"id":"cx","label":"СВОЙ ХОД","freeform":true,"limit":80}

\],

"consequences":{

"success":\["tag:+advantage","alarm:-1"\],

"partial":\["hp:-1","status:Ranen"\],

"fail":\["alarm:+1","spawn:ambush?"\]

},

"media":{"image":true,"tts":false}

}

**Приложение D. Party & Co-DM Protocol (state-диаграмма)**

\[DRAFT\] --validate--> \[READY\] --publish--> \[LIVE\] --retcon(≤1)--> \[LIVE-1\]

| |--override(with reason)--> \[LIVE\] (audit log)

\\--edit------------------>\[DRAFT\]

**Приложение E. Редкости/метки (визуальные)**

| **Редкость** | **Цвет/метка** | **Примеры** |
| --- | --- | --- |
| Common | серый | расходники, базовые инструменты |
| Uncommon | зелёный | улучшенные инструменты, простые чары |
| Rare | синий | сильные утилити, первые сет-эффекты |
| Epic | фиолетовый | уникальные перки/комбо |
| Legendary | оранжевый | сюжетные артефакты |
| Mythic | красный/реликт | сезонные/ивентовые, чаще soulbound |

**Приложение F. Acceptance для Vertical Slice**

- **Контент:** 1 локация, ≥2 сцены из разных шаблонов + 1 бой (Combat-Lite).
- **Игровые системы:** core loop «3+Свой», пати-голосование, Co-DM (override/реткон/аудит).
- **Персонаж/Инвентарь:** 6 пресетов, базовые слоты, редкости ×6, лут-дроп.
- **Медиа:** фон-арт (опц.), TTS (опц.).
- **Настройки:** доступность, контент-фильтры, базовые геймплейные тумблеры.
- **Логи/телеметрия:** темп, доли исходов, голосования, AFK.
- **Без NFT/Биржи** в MVP; точки интеграции помечены.

**Риск-лог главы (кратко)**

- Переусложнение редактора → решаем «скелетами» и валидаторами.
- Баланс навыков/сет-эффектов → перенесён в отдельное обсуждение (баланс-глава).
- Медиа-стоимость (TTS/изображения) → учтём в главах про Данные/Операции, без «энергии».

**Это финальная редакция главы 1.**  
Готов перейти к **Главе 2: «UX-флоу & UI-навигация»** — соберу пользовательские сценарии (Solo/Party/GM), дерево экранов/энд-страниц, макеты панелей ИИ-ярлыков и поведение таймера/голосования в интерфейсе.